# Nuclear At Home

| Category | Difficulty | Point |
| :-: | :-: | :-: |
| Network | Hard | 500 |

Format: `CSUBRU{MD5(MinSpeed:Duration,MaxSpeed:Duration)}`

สมพรอยากให้ประเทศไทยมีโรงไฟฟ้าพลังงานนิวเคลียร์ แต่กลับโดนกระแสตีกลับ ทั้งที่ความตั้งใจของเขามีแค่อยากให้ค่าไฟถูกลงเท่านั้นเอง ประเทศไทยเองก็ไม่ได้มีภัยธรรมชาติรุนแรงบ่อยนัก แต่เขากลับถูกต่อว่าเสียๆ หายๆ ทั้งถูกเหน็บว่าอยากให้ประเทศกลายเป็นเชอร์โนบิล 2 ถ้าอยากได้จริงก็ลองไปตั้งไว้หลังบ้านตัวเองสิแล้วจะรู้สึกบ้าง สมพรได้แต่คิดว่า "เอาสิ!" จากนั้นเขาจึงซื้ออุปกรณ์และ U238 มาทำการ enrichment เองที่ห้องแล็บหลังบ้าน เพื่อประหยัดค่าใช้จ่ายจากการซื้อ U235 ที่สำเร็จรูปมาแล้ว
คืนหนึ่ง ขณะกำลังนอนพัก เขาได้ยินเสียงเครื่องปั่นทำงานแรงผิดปกติในช่วงหนึ่ง จนสงสัยว่า PLC controller อาจถูกโจมตี เขาจึงส่งไฟล์ pcap ที่บันทึก Network traffic ทั้งหมดในบ้านมาให้คุณตรวจสอบ คุณพอจะช่วยบอกได้ไหมว่า attacker ทำให้ใบพัดหมุนด้วยความเร็วเท่าไร และเป็นเวลานานกี่วินาที

---

## Hints

- hint: ตัวอย่าง flag CSUBRU{MD5(1:600,100:900)}   CSUBRU{cc8386c2a46998cff6ba739f27b9ca1a}

---

## Configuration

| Name | Value |
| :- | :- |
| Title | Nuclear At Home |
| Type | Static Attachments |
| Category | Forensics |
| Max Attempts Allowed | Unlimited |
| Blood Bonus | Enable |
| Container Image | N/A |
| Service Port | N/A |
| CPU Limit (0.1 CPUs) | N/A |
| Memory Limit (MB) | N/A |
| Storage Limit (MB) | N/A |

### Attachments

- `nuclear-at-home.pcapng`

### Flags

- `CSUBRU{a5a32283ec98f7aeae7763ffd2a25f43}`

---

## Analysis

```text
445    131.3257  47241000   <-- overspeed 42,000 rpm
465    136.3271  47241000
481    141.3287  47241000
497    146.3302  47241000
513    151.3317  47241000
534    156.3332  47241000

555    161.3281  40400000   <-- stall 3 rpm
571    166.3296  40400000
587    171.3311  40400000
603    176.3326  40400000
619    181.3352  40400000
635    186.3399  40400000
```

```txt
tshark -r /tmp/x.pcapng \
  -Y "s7comm && s7comm.param.func == 0x05 && s7comm.param.item.address == 0x000020" \
  -T fields -e frame.number -e frame.time_relative -e s7comm.resp.data
เวลาให้เอา เวลาของ frame ที่เริ่ม set - frame ก่อนจะ set
34      10.597822732    458fc000
166     55.611788320    4591b47b
301     105.627784315   45907885
445     131.325698736   47241000
465     136.327108743   47241000
481     141.328705253   47241000
497     146.330196371   47241000
513     151.331704740   47241000
519     155.643551338   45931cb8
534     156.333205245   47241000
555     161.328109738   40400000
571     166.329587004   40400000
587     171.331090482   40400000
603     176.332581511   40400000
619     181.335239233   40400000
635     186.339852965   40400000
659     191.329584179   458fc000
675     196.331114387   458fc000
695     201.332598514   458fc000
701     205.658963923   458fe5cb
716     206.334240329   458fc000
732     211.335831870   458fc000
748     216.337301488   458fc000
852     255.674889853   458c7bf4
991     305.690739952   45927266
1133    355.706201726   458f6a1b
1281    405.722082752   45915185
1369    431.322847692   458fc000
1465    455.737633374   4591b49e
1622    505.752987784   45931448
1781    555.768739624   458ee422
1936    605.784446229   458ebae6
2091    655.799895875   4590521f
```

Answer: `3:25,42000:20`
MD5: `a5a32283ec98f7aeae7763ffd2a25f43`
